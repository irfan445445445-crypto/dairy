<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Login — Diary 2.0</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="login-container fade-in">
  <h2>Enter Password</h2>
  <input 
    type="password" 
    id="passwordInput" 
    placeholder="Enter 4-digit password" 
    maxlength="4"        <!-- restricts to 4 characters -->
   number only     <!-- ensures exactly 4 digits --> <!-- numeric keyboard on mobile -->
  >
  <button id="loginBtn">Login</button>
  <p id="errorMsg" style="color:red;"></p>
</div>

<script>
const passwordInput = document.getElementById("passwordInput");

// Prevent non-numeric input and enforce 4-digit limit
passwordInput.addEventListener("input", (e) => {
  e.target.value = e.target.value.replace(/\D/g, ""); // remove non-digits
  if (e.target.value.length > 4) e.target.value = e.target.value.slice(0, 4); // max 4 digits
});

document.getElementById("loginBtn").addEventListener("click", () => {
  const pwd = passwordInput.value.trim();

  let mode = null;
  if (pwd === "1234") mode = "view";
  else if (pwd === "4321") mode = "admin";
  else {
    document.getElementById("errorMsg").textContent = "❌ Incorrect password.";
    return;
  }

  // send loginSuccess to parent
  parent.postMessage({ type: "loginSuccess", mode }, "*");

  // fade out
  document.querySelector(".login-container").style.opacity = "0";
  setTimeout(() => document.querySelector(".login-container").style.display = "none", 400);
});
</script>
</body>
</html>
